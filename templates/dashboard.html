{% extends "base.html" %}

{% block title %}–ü–∞–Ω–µ–ª—å ‚Äî –§–∞–π–ª–æ–æ–±–º–µ–Ω–Ω–∏–∫{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-box" style="max-width: 800px; width: 90%;">
        <h2>üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</h2>
        <form method="POST" enctype="multipart/form-data">
            <div class="form-group">
                <label for="file">–§–∞–π–ª</label>
                <input type="file" id="file" name="file" required>
            </div>
            <div class="form-group">
                <label for="pin_code">PIN-–∫–æ–¥ (–º–∏–Ω. 4 —Å–∏–º–≤–æ–ª–∞)</label>
                <input type="text" id="pin_code" name="pin_code" minlength="4" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 1234">
            </div>
            <div class="form-group">
                <label for="download_limit">–õ–∏–º–∏—Ç —Å–∫–∞—á–∏–≤–∞–Ω–∏–π (1‚Äì100)</label>
                <input type="number" id="download_limit" name="download_limit" min="1" max="100" value="5" required>
            </div>
            <div class="form-group">
                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; font-weight: 500; color: var(--text-primary);">
                    <input type="checkbox" name="auto_delete" value="1" style="width: 18px; height: 18px; accent-color: var(--primary);">
                    –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª –ø–æ—Å–ª–µ –∏—Å—á–µ—Ä–ø–∞–Ω–∏—è –ª–∏–º–∏—Ç–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π
                </label>
                <p style="margin-top: 6px; font-size: 13px; color: var(--text-muted);">
                    –ï—Å–ª–∏ –æ—Ç–º–µ—á–µ–Ω–æ ‚Äî —Ñ–∞–π–ª –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—ë–Ω —Å —Å–µ—Ä–≤–µ—Ä–∞, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –±—É–¥–µ—Ç —Å–∫–∞—á–∞–Ω —É–∫–∞–∑–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ —Ä–∞–∑.
                </p>
            </div>
            <button type="submit" class="btn btn-primary">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</button>
        </form>
    </div>

    {% if files %}
    <div class="auth-box" style="max-width: 800px; width: 90%; margin-top: 30px;">
        <h2>üìÅ –ú–æ–∏ —Ñ–∞–π–ª—ã</h2>
        <div style="max-height: 400px; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: var(--radius-md); background: white;">
            <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
                <thead>
                    <tr style="background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white;">
                        <th style="text-align: left; padding: 12px 16px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">–§–∞–π–ª</th>
                        <th style="text-align: left; padding: 12px 16px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">–°–∫–∞—á–∏–≤–∞–Ω–∏–π</th>
                        <th style="text-align: left; padding: 12px 16px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">–ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ</th>
                        <th style="text-align: left; padding: 12px 16px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    {% for f in files %}
                    <tr style="border-bottom: 1px solid #e2e8f0;">
                        <td style="padding: 12px 16px; word-break: break-all; max-width: 200px;">{{ f.filename }}</td>
                        <td style="padding: 12px 16px;">{{ f.download_count }} / {{ f.download_limit }}</td>
                        <td style="padding: 12px 16px;">
                            {% if f.auto_delete %}
                                <span style="color: var(--success); display: flex; align-items: center; gap: 6px;">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                                    </svg>
                                    –î–∞
                                </span>
                            {% else %}
                                <span style="color: var(--text-muted);">–ù–µ—Ç</span>
                            {% endif %}
                        </td>
                        <td style="padding: 12px 16px; white-space: nowrap;">
                            <a href="{{ f.download_url }}" target="_blank"
                               style="display: inline-block; margin-right: 8px; padding: 6px 12px; background: var(--primary); color: white; text-decoration: none; border-radius: var(--radius-sm); font-size: 13px; font-weight: 500;">
                                –°–∫–∞—á–∞—Ç—å
                            </a>
                            <form method="POST" action="{{ url_for('delete_file', token=f.token) }}"
                                  style="display: inline-block;"
                                  onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å \\'{{ f.filename }}\\' ?');">
                                <button type="submit"
                                        style="padding: 6px 12px; background: var(--danger); color: white; border: none; border-radius: var(--radius-sm); cursor: pointer; font-size: 13px; font-weight: 500;">
                                    –£–¥–∞–ª–∏—Ç—å
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% else %}
    <div class="auth-box" style="max-width: 800px; width: 90%; margin-top: 30px;">
        <p style="text-align: center; color: var(--text-muted);">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.</p>
    </div>
    {% endif %}
</div>
{% endblock %}